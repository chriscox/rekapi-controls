/**
 * Rekapi Controls - UI controls for Rekapi animations. v0.3.8
 *   By Jeremy Kahn - jeremyckahn@gmail.com
 *   https://github.com/jeremyckahn/rekapi-controls
 *
 * Make Rekapi animations interactive and fun.
 * Dependencies: Rekapi (https://github.com/jeremyckahn/rekapi), Underscore.js (https://github.com/documentcloud/underscore), Shifty.js (https://github.com/jeremyckahn/shifty), jQuery (https://github.com/jquery/jquery)
 * MIT Lincense.  This code free to use, modify, distribute and enjoy.
 */
(function(j){function a(g,c){var b,a;this.kapi=g;this.$contextEl=f(c);b=f(g.context);a=f(k);b.after(a);this.$container=a=b.next();b=a.find(".rekapi-scrubber-timeline");b.dragonSlider({drag:f.proxy(function(a){g.pause();this.syncAnimationToPercent(a)},this)});this.$timeline=b;a.width(this.$contextEl.width());this.syncPlayStateButtons();var d=this,e,h;e=d.kapi;a=d.$container.find(".rekapi-scrubber-play");b=d.$container.find(".rekapi-scrubber-pause");h=d.$container.find(".rekapi-scrubber-stop");a.on("click",
function(a){a.preventDefault();e.play()});b.on("click",function(a){a.preventDefault();e.pause()});h.on("click",function(a){a.preventDefault();e.stop(!0)});e.on("playStateChange",function(){d.syncPlayStateButtons()});e.on("stop",function(){d.resetScrubber()});e.on("afterUpdate",function(){d.updateScrubber()});return this}var k='<div class="rekapi-scrubber-wrapper"><div class="rekapi-scrubber"><a class="rekapi-scrubber-button rekapi-scrubber-play" href="#"><span class="icon icon-play"></span></a><a class="rekapi-scrubber-button rekapi-scrubber-pause" href="#"><span class="icon icon-pause"></span></a><div class="rekapi-scrubber-timeline"></div><a class="rekapi-scrubber-button rekapi-scrubber-stop" href="#"><span class="icon icon-stop"></span></a></div></div>',
f=jQuery;a.prototype.syncPlayStateButtons=function(){var a,c,b;a=this.kapi;c=this.$container.find(".rekapi-scrubber-play");b=this.$container.find(".rekapi-scrubber-pause");a.isPlaying()?(c.css({display:"none"}),b.css({display:"block"})):(c.css({display:"block"}),b.css({display:"none"}));return this};a.prototype.updateScrubber=function(){this.$timeline.dragonSliderSet(this.kapi.lastPositionUpdated(),!1)};a.prototype.resetScrubber=function(){this.$timeline.dragonSliderSet(0,!1)};a.prototype.syncAnimationToScrubber=
function(){this.syncAnimationToPercent(this.$timeline.dragonSliderGet())};a.prototype.syncAnimationToPercent=function(a){this.syncAnimationToMillisecond(a*this.kapi.animationLength())};a.prototype.syncAnimationToMillisecond=function(a){var c;c=Tweenable.now();this.kapi.update(a);this.kapi._loopTimestamp=c-a;this.kapi._pausedAtTime=c};j.RekapiScrubber=a})(this);
